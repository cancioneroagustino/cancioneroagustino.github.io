<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Conversor de Listado a JSON de Canciones</title>
  <!-- Carga la definición de los formularios y canciones de crear-programa.html -->
  <script src="crear-programa.html"></script>
  <style>
    body { font-family: sans-serif; margin: 2em; }
    textarea { width: 100%; height: 6em; }
    pre { background: #f6f6f6; padding: 1em; border-radius: 8px; }
  </style>
</head>
<body>
  <h1>Conversor de Listado de Programa a JSON</h1>
  <p>Pega aquí el <strong>link de compartir listado</strong> generado en "crear-programa.html":</p>
  <textarea id="input"></textarea>
  <button onclick="convertir()">Convertir a JSON</button>
  <h2>Resultado para canciones.json</h2>
  <pre id="output"></pre>
  <script>
    // Asume que en crear-programa.html existe una variable global "cancionesPorSeccion"
    // Ejemplo: cancionesPorSeccion = { "Entrada": [ {nombre: "...", ruta: "..."} ], ... }

    function convertir() {
      const urlStr = document.getElementById('input').value.trim();
      if (!urlStr) return;
      const url = new URL(urlStr);
      const params = url.searchParams;

      let resultado = [];
      for (const [seccion, nombreCorto] of params.entries()) {
        // Busca en el array de la sección
        const arr = window.cancionesPorSeccion?.[seccion] || [];
        const item = arr.find(x => x.nombre === nombreCorto);
        resultado.push({
          seccion,
          nombre: nombreCorto,
          ruta: item?.ruta || "NO ENCONTRADA"
        });
      }
      document.getElementById('output').textContent = JSON.stringify(resultado, null, 2);
    }
  </script>
</body>
</html>