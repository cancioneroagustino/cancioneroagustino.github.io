<!DOCTYPE html>
<html lang="es">
<head>
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-YES9XTRYX6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-YES9XTRYX6');
  </script>
  <meta charset="utf-8">
  <title>Crea tu programa de misa</title>
  <meta name="viewport" content="width=device-width, height=device-height, initial-scale=1.0">
  <link rel="canonical" href="https://www.cancionerocatolico.cl/crear-programa.html">
  <link rel="stylesheet" type="text/css" href="css/cancionero.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
</head>

<body>
  <div id="nav-placeholder"></div>

  <div>
    <h1 class="seccion">Crea tu Programa de Misa</h1>
  </div>

  <div class="col-10 mx-auto">
    <form id="programa-form">
      <h2>Agregar Canciones</h2>
      <label for="seccion">Sección de la Misa:</label>
      <select id="seccion">
        <option value="Entrada">Entrada</option>
        <option value="Perdón">Perdón</option>
        <option value="Gloria">Gloria</option>
        <option value="Gloria_no_litúrgico">Gloria no litúrgico</option>
        <option value="Aleluya">Aleluya</option>
        <option value="Leccional">Leccionales</option>
        <option value="Ofertorio">Ofertorio</option>
        <option value="Santo">Santo</option>
        <option value="Santo_no_litúrgico">Santo no litúrgico</option>
        <option value="Padrenuestro">Padrenuestro</option>
        <option value="Padrenuestro_no_litúrgico">Padrenuestro no litúrgico</option>
        <option value="Paz">Paz</option>
        <option value="Cordero">Cordero</option>
        <option value="Comunión">Comunión</option>
        <option value="Espíritu_Santo">Espíritu Santo</option>
        <option value="Salida">Salida</option>
        <option value="Mariano">Marianos</option>
        <option value="Rosario">Santo Rosario</option>
        <option value="Matrimonio">Matrimonio</option>
        <option value="Liturgia_especial">Liturgias especiales</option>
        <option value="Agustiniano">Agustinianos</option>
        <option value="Villancico">Villancicos</option>
        <option value="Varios">Cantos varios</option>
      </select>

      <label for="canto">Canción:</label>
      <select id="canto">
        <!-- Las opciones se llenarán dinámicamente -->
      </select>

      <button type="button" id="agregar-cancion" class="btn btn-outline-primary">Agregar Canción</button>
    </form>

    <h2>Programa de Misa</h2>
    <ul id="programa-lista">
      <!-- Las canciones seleccionadas se mostrarán aquí -->
    </ul>

    <button id="crear-programa" class="btn btn-outline-primary mb-5">Crear Programa</button>
    <button id="compartir-programa" class="btn btn-outline-secondary mb-5">Compartir Programa</button>
  </div>

  <script>
    const canciones = {
      Entrada: {'Abre tu jardín': 'Entrada/Abre tu jardín.html', 'Aclaró': 'Entrada/Aclaró.html', 'Adeste fideles': 'Entrada/Adeste fideles.html', 'Al caer la tarde': 'Entrada/Al caer la tarde.html'},
      Perdón: {'Oh Señor ten piedad 1 (RE)': 'Perdón/Oh Señor ten piedad 1 (RE).html', 'Oh Señor ten piedad 2 (LA)': 'Perdón/Oh Señor ten piedad 2 (LA).html', 'Oh Señor ten piedad 3 (Pablo)': 'Perdón/Oh Señor ten piedad 3 (Pablo).html'},
      Gloria: {'Gloria (Misa rítmica)': 'gloria/Gloria (Misa rítmica).html', 'Gloria (C. Fones)': 'gloria/Gloria (C. Fones).html', 'Gloria (Ma José Bravo y C. Fones)': 'gloria/Gloria (Ma Jose Bravo y C. Fones).html'},
      Gloria_no_litúrgico: {'Gloria Salesianos (Misa joven)': 'gloria/Gloria Salesianos (Misa joven).html', 'Gloria Trinidad': 'gloria/Gloria Trinidad.html', 'Gloria abreviado': 'gloria/Gloria abreviado.html'},
      Aleluya: {'Aleluya gregoriano':'Aleluya/Aleluya gregoriano.html', 'Aleluya SOL (1)':'Aleluya/Aleluya SOL (1).html', 'Aleluya SOL (2)':'Aleluya/Aleluya SOL (2).html', 'Aleluya, Busca primero':'Aleluya/Aleluya, Busca primero.html'},
      Leccional: {'Alabanza y gloria':'Leccionales/Alabanza y gloria.html', 'Alabe todo el mundo':'Leccionales/Alabe todo el mundo.html', 'Amén, amén, amén':'Leccionales/Amén, amén, amén.html'},
      Ofertorio: {'Amar es entregarse': 'Ofertorio/Amar es entregarse.html', 'Bendito seas Señor': 'Ofertorio/Bendito seas Señor.html', 'Después de preparar': 'Ofertorio/Después de preparar.html'},
      Santo: {'Santo Cristóbal Fones':'Santo/Santo Cristóbal Fones.html', 'Santo DO (1)':'Santo/Santo DO (1).html', 'Santo DO (2)':'Santo/Santo DO (2).html', 'Santo Encuentro continental':'Santo/Santo Encuentro continental.html'},
      Santo_no_litúrgico: {'Santo Betsaida':'Santo/Santo Betsaida.html', 'Santo MIm':'Santo/Santo MIm.html', 'Santo Misa comunitaria':'Santo/Santo Misa comunitaria.html', 'Santo REm':'Santo/Santo REm.html'},
      Padrenuestro: {'Padrenuestro 1 (SOL)':'Padrenuestro/Padrenuestro 1 (SOL).html', 'Padrenuestro 2 (DO)':'Padrenuestro/Padrenuestro 2 (DO).html', 'Padrenuestro 3 (DO)':'Padrenuestro/Padrenuestro 3 (DO).html'},
      Padrenuestro_no_litúrgico: {'Padrenuestro misionero':'Padrenuestro/Padrenuestro misionero.html', 'Padre nuestro, Tú que estás':'Padrenuestro/Padre nuestro, Tú que estás.html'},
      Paz: {'Contemplando el mar (chilote)':'Paz/Contemplando el mar (chilote).html', 'El Santísimo de la paz':'Paz/El Santísimo de la paz.html', 'Hemos venido aquí':'Paz/Hemos venido aquí.html'},
      Cordero: {'Cordero de Dios DO (1) - Paz sin fronteras':'Cordero/Cordero de Dios DO (1).html', 'Cordero de Dios DO (2)':'Cordero/Cordero de Dios DO (2).html', 'Cordero de Dios SIm':'Cordero/Cordero de Dios SIm.html'},
      Comunión: {'A todos doy':'Comunión/A todos doy.html', 'Abandónate':'Comunión/Abandónate.html', 'Adorando':'Comunión/Adorando.html', 'Adoremos reverentes':'Comunión/Adoremos reverentes.html'},
      Espíritu_Santo: {'Bautismo':'Espíritu Santo/Bautismo.html', 'Como antes, más que antes':'Espíritu Santo/Como antes, más que antes.html', 'Derrama':'Espíritu Santo/Derrama.html', 'Divino Consolador':'Espíritu Santo/Divino Consolador.html'},
      Salida: {'Envíanos Señor':'Salida/Envíanos Señor.html', 'El Reino de la vida':'Salida/El Reino de la vida.html', 'Fronteras':'Salida/Fronteras.html', 'Id y anunciad':'Salida/Id y anunciad.html'},
      Mariano: {'Regina coeli':'Marianos/Regina coeli.html', 'Reina del cielo':'Marianos/Reina del cielo.html', 'Salve Regina':'Marianos/Salve Regina.html', 'La salve':'Marianos/La salve.html', 'Santa María del camino':'Marianos/Santa María del camino.html'},
      Rosario: {'Oración inicial del mes de María':'Rosario/Oración inicial del mes de María.html', 'Misterios gozosos (lunes y sábado)':'Rosario/Misterios gozosos.html', 'Misterios dolorosos (martes y viernes)':'Rosario/Misterios dolorosos.html'},
      Matrimonio: {'A prometerte vengo':'Matrimonio/A prometerte vengo.html', 'Alianza entre tú y yo':'Matrimonio/Alianza entre tú y yo.html', 'Apura el paso':'Matrimonio/Apura el paso.html', 'A tu lado':'Matrimonio/A tu lado.html'},
      Liturgia_especial: {'Ahora, Señor':'Liturgias especiales/Ahora, Señor.html', 'Cena pascual':'Liturgias especiales/Cena pascual.html', 'Con estas cenizas, Señor':'Liturgias especiales/Con estas cenizas, Señor.html'},
      Agustiniano: {'Canción a Santa Mónica':'Agustinianos/Canción a Santa Mónica.html', 'Creados para Ti':'Agustinianos/Creados para Ti.html', 'Corazón inquieto':'Agustinianos/Corazón inquieto.html'},
      Villancico: {'A las doce de la noche':'Villancicos/A las doce de la noche.html', 'Aire navideño':'Villancicos/Aire navideño.html', 'Burrito sabanero':'Villancicos/Burrito sabanero.html'},
      Varios: {'Canción a Alberto Hurtado':'Varios/Canción a Alberto Hurtado.html', 'Himno a San José':'Varios/Himno a San José.html', 'Himno a Santa Teresa de Los Andes':'Varios/Himno a Santa Teresa de Los Andes.html'},
    };

    const seccionSelect = document.getElementById('seccion');
    const cantoSelect = document.getElementById('canto');
    const programaLista = document.getElementById('programa-lista');
    const programa = [];

    function actualizarCanciones() {
      const seccion = seccionSelect.value;
      const opciones = canciones[seccion];
      cantoSelect.innerHTML = '';
      for (const [nombreCorto, ruta] of Object.entries(opciones)) {
        const option = document.createElement('option');
        option.value = ruta;
        option.textContent = nombreCorto;
        cantoSelect.appendChild(option);
      }
    }

    seccionSelect.addEventListener('change', actualizarCanciones);

    document.getElementById('agregar-cancion').addEventListener('click', function() {
      const seccion = seccionSelect.value;
      const cancion = cantoSelect.value;
      const nombreCorto = cantoSelect.options[cantoSelect.selectedIndex].text;
      programa.push({seccion, cancion});
      const li = document.createElement('li');
      li.textContent = `${seccion}: ${nombreCorto}`;
      programaLista.appendChild(li);
    });

    document.getElementById('crear-programa').addEventListener('click', function() {
      localStorage.setItem('programaMisa', JSON.stringify(programa));
      window.location.href = 'programa.html';
    });

    document.getElementById('compartir-programa').addEventListener('click', function() {
      const query = programa.map(item => `${encodeURIComponent(item.seccion)}=${encodeURIComponent(item.cancion)}`).join('&');
      const url = `${window.location.origin}${window.location.pathname}?${query}`;
      prompt("Comparte este enlace para compartir tu programa de misa:", url);
    });

    function cargarProgramaDesdeURL() {
      const params = new URLSearchParams(window.location.search);
      params.forEach((cancion, seccion) => {
        programa.push({seccion, cancion});
        const nombreCorto = cancion;  // En este caso, no tenemos el nombre corto real, pero se puede ajustar si es necesario.
        const li = document.createElement('li');
        li.textContent = `${seccion}: ${nombreCorto}`;
        programaLista.appendChild(li);
      });
    }

    // Inicializar la lista de canciones
    actualizarCanciones();
    // Cargar programa desde la URL si existen parámetros
    cargarProgramaDesdeURL();
  </script>
</body>
</html>