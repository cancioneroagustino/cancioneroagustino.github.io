<!DOCTYPE html>
<html dir="ltr" mozdisallowselectionprint>
<head>
  <meta charset="utf-8" />
  <title>Visor PDF</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Carga los estilos básicos de PDF.js -->
  <link rel="stylesheet" href="../web/viewer.css" />

  <!-- Carga el script principal -->
  <script src="../build/pdf.js"></script>
</head>

<body tabindex="1">

  <!-- Contenedor principal -->
  <div id="viewerContainer">
    <div id="viewer" class="pdfViewer"></div>
  </div>

  <script>
    const urlParams = new URLSearchParams(window.location.search);
    const file = urlParams.get("file");

    if (!file) {
      document.body.innerHTML = "<p style='text-align:center;padding:2em;'>No se especificó ningún PDF.</p>";
    } else {
      const CMAP_URL = "../web/cmaps/";
      const CMAP_PACKED = true;

      const container = document.getElementById("viewerContainer");

      const eventBus = new pdfjsViewer.EventBus();
      const pdfLinkService = new pdfjsViewer.PDFLinkService({ eventBus });
      const pdfFindController = new pdfjsViewer.PDFFindController({
        eventBus,
        linkService: pdfLinkService,
      });

      const pdfViewer = new pdfjsViewer.PDFViewer({
        container,
        eventBus,
        linkService: pdfLinkService,
        findController: pdfFindController,
      });

      pdfLinkService.setViewer(pdfViewer);
      pdfjsLib.GlobalWorkerOptions.workerSrc = "../build/pdf.worker.js";

      pdfjsLib.getDocument({ url: file, cMapUrl: CMAP_URL, cMapPacked: CMAP_PACKED }).promise.then(pdfDoc => {
        pdfViewer.setDocument(pdfDoc);
        pdfLinkService.setDocument(pdfDoc, null);
      });
    }
  </script>
</body>
</html>
